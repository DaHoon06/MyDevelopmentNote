<!DOCTYPE html>
<html>
<head>
    <%-include('../../header') %>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
</head>
<style>
    .table-title-label{
        width: 150px;
    }
    .table-title-label:hover{
        color:black;
        cursor:auto;
    }
    .chart-card{
        min-height: 264px;
        max-height: 300px;
    }
    thead>tr>th:first-child{
        width: 100px;
    }
    .chartDiv_left{
        width:150px;
        margin-left:25px;
        margin-right:25px;
    }
    .chartDiv_left>p{
        /*border:3px solid;*/
        /*border-radius: 30px;*/
    }
    .color_icon{
        width: 20px;
        height: 20px;
        border-radius: 5px;
        margin:0;
    }
    .color1{
        background-color: rgb(255, 99, 132);
    }
    .color2{
        background-color: rgb(54, 162, 235);
    }
</style>
<body>

<%if(data.error){%><pre style="width: 400px;white-space: pre-wrap;"><%-data.error%></pre><%}%>
<%
var quotaGenderData = data.quotaGenderData
var quotaAgeData = {
    label : ["20's","30's","40's","50's and \n over"],
    age : data.quotaAgeData.age,
    successData : data.quotaAgeData.successData
}
var qDataQ1_1 = data.qDataQ1_1;
var qDataQ1_2 = data.qDataQ1_2;
var qDataQ2 = data.qDataQ2;
var qDataQ3 = data.qDataQ3;
%>

<% for(var i=0; i<=0; i++){%>
<div class=".container display-flex justify-center mt-3" style="min-width: 1750px;">
    <div class="card text-center p-5 w-25" style="min-width: 600px;" >
        <div class="display-flex" style="justify-content: space-between">
            <h3 class="pt-4">
                <a style="color:gray" href="/static/634/i-dash-board">ICN</a>
            </h3>
            <h1 class="card-title">
                BUSAN
            </h1>
            <h3 class="pt-4">
                <a style="color:gray" href="/static/652/j-dash-board">JPN</a>
            </h3>
        </div>
        <hr>
        <h3>QUOTA</h3>
        <div class="card-body">
            <h5 class="card-title">BUSAN GENDER</h5>
        </div>

        <table class="table table-striped pure-table-bordered">
            <thead style="border-bottom:3px solid">
            <tr>
                <th scope="col" ></th>
                <th scope="col">
                    <label class="table-title-label">
                        MALE
                    </label>
                </th>
                <th scope="col">
                    <label class="table-title-label" >
                        FEMALE
                    </label>
                </th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th scope="row">TOTAL</th>
                <td>
                    <%= quotaGenderData.male %>
                </td>
                <td>
                    <%= quotaGenderData.female %>
                </td>
            </tr>
            </tbody>
        </table>
        <hr>
        <div class="card-body">
            <h5 class="card-title">BUSAN QUOTA</h5>
        </div>
        <table class="table table-striped pure-table-bordered">
            <thead style="border-bottom:3px solid">
                <tr>
                    <th scope="col"></th>
                    <th scope="col">
                        <label class="table-title-label">
                            QUOTA
                        </label>
                    </th>
                    <th scope="col">
                        <label class="table-title-label" >
                            Success(N)%
                        </label>
                    </th>
                </tr>
            </thead>
            <tbody>
            <% for(var i=0; i<=quotaAgeData.label.length-1; i++){ %>
                <tr>
                    <th scope="row">
                        <%= quotaAgeData.label[i] %>
                    </th>
                    <td>
                        <%= quotaAgeData.age[i] %>
                    </td>
                    <td>
                        <%= quotaAgeData.successData[i] %>
                    </td>
                </tr>
            <% } %>
            </tbody>
        </table>
    </div>

    <div class="display-flex flex-column  w-50" style="justify-content: space-between; min-width: 1000px;">
        <div class="card display-flex text-center chart-card"  style="flex-direction:row">
            <div class="chartDiv_left pt-3" >
                <p class="h3 mt-3">
                    Q1-1 : %
                    <label class="color_icon color1"></label>
                </p>
                <p class="h3 mt-3">
                    Q1-2 : %
                    <label class="color_icon color2"></label>
                </p>
            </div>
            <div class="p-3">
                <canvas id="myChart1" width="700" height="260"></canvas>
            </div>
        </div>

        <div class="card display-flex text-center chart-card"  style="flex-direction:row">
            <div class="chartDiv_left  pt-3" >
                <p class="h3 mt-3">
                    Q2
                    <label class="color_icon color1"></label>
                </p>
            </div>
            <div class="p-3">
                <canvas id="myChart2" width="700" height="260"></canvas>
            </div>
        </div>

        <div class="card display-flex text-center chart-card"  style="flex-direction:row">
            <div class="chartDiv_left  pt-3" >
                <p class="h3 mt-3">
                    Q3
                    <label class="color_icon color1"></label>
                </p>
            </div>
            <div class="p-3">
                <canvas id="myChart3" width="700" height="260"></canvas>
            </div>
        </div>
    </div>
</div>
<% } %>
</body>
<script>
    $(function(){
        var q1_1_data = [<%= qDataQ1_1 %>]
        var q1_2_data = [<%= qDataQ1_2 %>]
        var q2_data = [<%= qDataQ2 %>]
        var q3_data = [<%= qDataQ3 %>]

        var ctx1 = document.getElementById('myChart1').getContext('2d');
        var ctx2 = document.getElementById('myChart2').getContext('2d');
        var ctx3 = document.getElementById('myChart3').getContext('2d');

        var datalabels = {
            align: 'top',
            anchor: 'end',
        }

        var defaultOption =  {
            responsive:false,
            plugins: {
                legend: false,
            },
            scales: {
                y: {
                    beginAtZero: true,
                    max:100,
                    ticks:{
                        stepSize:10
                    }
                },
                x: {
                    beginAtZero: true,
                    type: 'category',
                }
            }
        };

        var customOption =  {
            responsive:false,
            plugins: {
                legend: false,
            },
            scales: {
                y: {
                    beginAtZero: true,
                    max:11,
                    ticks:{
                        stepSize:1
                    }
                },
                x: {
                    beginAtZero: true,
                    type: 'category',
                }
            }
        };

        var Q1_DATA = {
            labels: [['Extremely','unhappy'], '', '', 'Neutral', '', '',['Extremely','happy']],
            datasets : [
                {
                    label: 'Q1-1',
                    data : q1_1_data,
                    borderColor:['rgba(255, 99, 132)'],
                    backgroundColor:['rgba(255, 99, 132)'],
                    datalabels
                },
                {
                    label: 'Q1-2',
                    data : q1_2_data,
                    borderColor:['rgba(54, 162, 235)'],
                    backgroundColor:['rgba(54, 162, 235)'],
                    datalabels
                },
            ]
        }

        var Q2_DATA = {
            labels: ['Q2-1 ', 'Q2-2', 'Q2-3', 'Q2-4', 'Q2-5', 'Q2-6','Q2-7','Q2-8'],
            datasets : [
                {
                    label: 'Q1-1',
                    data : q2_data,
                    borderColor:['rgba(255, 99, 132)'],
                    backgroundColor:['rgba(255, 99, 132)'],
                    max:11,
                    datalabels
                }
            ]
        }

        var Q3_DATA = {
            labels: ['Q3-1 ', 'Q3-2', 'Q3-3', 'Q3-4', 'Q3-5', 'Q3-6','Q3-7','Q3-8',"Q3-9","Q3-10","Q3-11"],
            datasets : [
                {
                    label: 'Q1-1',
                    data : q3_data,
                    borderColor:['rgba(255, 99, 132)'],
                    backgroundColor:['rgba(255, 99, 132)'],
                    datalabels
                }
            ]
        }


        function drawChart(ctx,data,selectOption){
            var option = {
                type: 'bar',
                data: data,
                plugins:[ChartDataLabels],
                showTooltips: false,
                options : selectOption
            }
            var myChart = new Chart(ctx,option)
        }





        drawChart(ctx1,Q1_DATA,defaultOption);
        drawChart(ctx2,Q2_DATA,customOption);
        drawChart(ctx3,Q3_DATA,customOption);





    });

</script>
</html>
